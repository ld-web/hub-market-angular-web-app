import{b as p}from"./chunk-3Y2CTNIX.js";import{J as r,M as a,R as u,da as o,ub as h}from"./chunk-ASW2YE55.js";var n="https://node-eemi.vercel.app/api",i="auth_token",l=class s{http=u(p);user=o(null);token=o(this.readToken());isAuthenticated=h(()=>!!this.token());constructor(){this.token()&&this.me().subscribe({error:()=>this.logout()})}register(t){return this.http.post(`${n}/auth/register`,t).pipe(r(e=>this.hydrateAuth(e)))}login(t){return this.http.post(`${n}/auth/login`,t).pipe(r(e=>this.hydrateAuth(e)))}me(){return this.http.get(`${n}/auth/me`).pipe(r(({user:t})=>this.user.set(t)))}logout(){this.user.set(null),this.token.set(null),localStorage.removeItem(i)}hydrateAuth(t){this.user.set(t.user),this.token.set(t.token),localStorage.setItem(i,t.token)}readToken(){try{return localStorage.getItem(i)}catch{return null}}static \u0275fac=function(e){return new(e||s)};static \u0275prov=a({token:s,factory:s.\u0275fac,providedIn:"root"})};export{l as a};
